
#define uint16  unsigned short
#define uint32  unsigned int

#define UINT32  *(volatile uint32*)

#define AHB_TIMER_LIMIT UINT32 0x52000000
#define AHB_TIMER_CTRL  UINT32 0x52000008
#define AHB_DA2         UINT32 0x55000000

#define LIMIT           0x000000FA
#define CONTROL         0x00000007
#define NUM_SAMPLES     400

volatile static uint16 ind = 0;
volatile static uint16 sin[NUM_SAMPLES] = {
0x800,0x820,0x840,0x860,0x880,0x8a0,0x8c0,0x8e0,0x900,0x920,0x940,0x960,0x97f,0x99f,0x9be,0x9dd,0x9fd,0xa1c,0xa3b,0xa5a,
0xa78,0xa97,0xab5,0xad3,0xaf1,0xb0f,0xb2d,0xb4a,0xb67,0xb84,0xba1,0xbbe,0xbda,0xbf6,0xc12,0xc2d,0xc49,0xc64,0xc7e,0xc99,
0xcb3,0xccd,0xce6,0xd00,0xd19,0xd31,0xd4a,0xd61,0xd79,0xd90,0xda7,0xdbe,0xdd4,0xdea,0xdff,0xe14,0xe29,0xe3d,0xe51,0xe65,
0xe78,0xe8b,0xe9d,0xeaf,0xec0,0xed1,0xee2,0xef2,0xf02,0xf11,0xf20,0xf2e,0xf3c,0xf4a,0xf57,0xf63,0xf6f,0xf7b,0xf86,0xf91,
0xf9b,0xfa4,0xfae,0xfb6,0xfbf,0xfc6,0xfce,0xfd4,0xfdb,0xfe1,0xfe6,0xfeb,0xfef,0xff3,0xff6,0xff9,0xffb,0xffd,0xffe,0xfff,
0xfff,0xfff,0xffe,0xffd,0xffb,0xff9,0xff6,0xff3,0xfef,0xfeb,0xfe6,0xfe1,0xfdb,0xfd4,0xfce,0xfc6,0xfbf,0xfb6,0xfae,0xfa4,
0xf9b,0xf91,0xf86,0xf7b,0xf6f,0xf63,0xf57,0xf4a,0xf3c,0xf2e,0xf20,0xf11,0xf02,0xef2,0xee2,0xed1,0xec0,0xeaf,0xe9d,0xe8b,
0xe78,0xe65,0xe51,0xe3d,0xe29,0xe14,0xdff,0xdea,0xdd4,0xdbe,0xda7,0xd90,0xd79,0xd61,0xd4a,0xd31,0xd19,0xd00,0xce6,0xccd,
0xcb3,0xc99,0xc7e,0xc64,0xc49,0xc2d,0xc12,0xbf6,0xbda,0xbbe,0xba1,0xb84,0xb67,0xb4a,0xb2d,0xb0f,0xaf1,0xad3,0xab5,0xa97,
0xa78,0xa5a,0xa3b,0xa1c,0x9fd,0x9dd,0x9be,0x99f,0x97f,0x960,0x940,0x920,0x900,0x8e0,0x8c0,0x8a0,0x880,0x860,0x840,0x820,
0x800,0x7df,0x7bf,0x79f,0x77f,0x75f,0x73f,0x71f,0x6ff,0x6df,0x6bf,0x69f,0x680,0x660,0x641,0x622,0x602,0x5e3,0x5c4,0x5a5,
0x587,0x568,0x54a,0x52c,0x50e,0x4f0,0x4d2,0x4b5,0x498,0x47b,0x45e,0x441,0x425,0x409,0x3ed,0x3d2,0x3b6,0x39b,0x381,0x366,
0x34c,0x332,0x319,0x2ff,0x2e6,0x2ce,0x2b5,0x29e,0x286,0x26f,0x258,0x241,0x22b,0x215,0x200,0x1eb,0x1d6,0x1c2,0x1ae,0x19a,
0x187,0x174,0x162,0x150,0x13f,0x12e,0x11d,0x10d,0xfd,0xee,0xdf,0xd1,0xc3,0xb5,0xa8,0x9c,0x90,0x84,0x79,0x6e,
0x64,0x5b,0x51,0x49,0x40,0x39,0x31,0x2b,0x24,0x1e,0x19,0x14,0x10,0xc,0x9,0x6,0x4,0x2,0x1,0x0,
0x0,0x0,0x1,0x2,0x4,0x6,0x9,0xc,0x10,0x14,0x19,0x1e,0x24,0x2b,0x31,0x39,0x40,0x49,0x51,0x5b,
0x64,0x6e,0x79,0x84,0x90,0x9c,0xa8,0xb5,0xc3,0xd1,0xdf,0xee,0xfd,0x10d,0x11d,0x12e,0x13f,0x150,0x162,0x174,
0x187,0x19a,0x1ae,0x1c2,0x1d6,0x1eb,0x200,0x215,0x22b,0x241,0x258,0x26f,0x286,0x29e,0x2b5,0x2ce,0x2e6,0x2ff,0x319,0x332,
0x34c,0x366,0x381,0x39b,0x3b6,0x3d2,0x3ed,0x409,0x425,0x441,0x45e,0x47b,0x498,0x4b5,0x4d2,0x4f0,0x50e,0x52c,0x54a,0x568,
0x587,0x5a5,0x5c4,0x5e3,0x602,0x622,0x641,0x660,0x680,0x69f,0x6bf,0x6df,0x6ff,0x71f,0x73f,0x75f,0x77f,0x79f,0x7bf,0x7df
};

void Timer_Handler() {
    AHB_DA2 = sin[ind];
    ind = (ind + 1) % NUM_SAMPLES;
}

int main(void) {
    AHB_TIMER_LIMIT = LIMIT;
    AHB_TIMER_CTRL  = CONTROL;
    while(1) {}
}
